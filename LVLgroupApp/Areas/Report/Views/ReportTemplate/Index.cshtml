@inject Microsoft.AspNetCore.Mvc.Localization.IViewLocalizer localizer
@{
    ViewData["Title"] = localizer["Modelos de Relatório"];
    ViewData["Caption"] = localizer["Configure aqui os seus modelos de relatórios."];
}
@using Core.Constants
@using LVLgroupApp.Areas.Report.Models.ReportTemplate
@model ReportTemplateViewModel



<div class="card p-3">

    <!--create / reload-->
    <div class="row mt-2">
        <!--create button-->
        <div class="col-lg-3 col-6">
            @if ((AuthorizationService.AuthorizeAsync(User, Permissions.QuestionTemplate.Create)).Result.Succeeded)
            {
                <a asp-area="Report" asp-controller="ReportTemplate" asp-action="OnGetCreate" class="btn btn-success mb-3">
                    <i class="fa fa-plus-square"></i> @localizer["Criar"]
                </a>
            }
        </div>
        <!--reload button-->
        <div class="col-lg-3 col-6">
            <a id="reload" class="btn btn-primary text-white w-100 mb-3">
                <i class="fa fas fa-bolt"></i>
                @localizer["Recarregar"]
            </a>
        </div>
    </div>

    <!--type / version-->
    <div class="row mt-2">
        <!--report type button-->
        <div class="col-lg-3 col-6">
            <div class="form-floating mb-3">
                <select id="ReportType" name="ReportType" class="form-select">
                    <option value="0">@localizer["Todos os tipos"]</option>
                    @foreach (var item in Model.ReportTypes)
                    {
                        <option value="@item.Value">@item.Text</option>
                    }
                </select>
                <label class="col-form-label" for="ReportType">@localizer["Tipo de relatório"]</label>
            </div>
        </div>
        <!--version selector-->
        <div class="col-lg-3 col-6">
            <div class="form-floating mb-3">
                <input id="VersionIndex" name="VersionIndex" type="number" class="form-control" step="1">
                <label class="col-form-label" for="DataDashboard">@localizer["Versão"]</label>
            </div>
        </div>
    </div>

    <!--active only selector-->
    <div class="row mt-2">
        <div class="col-lg-3 col-6">
            <div class="form-check form-switch mb-3">
                <input id="ActiveIndex" name="ActiveIndex" class="form-check-input" type="checkbox" role="checkbox" name="ActiveIndex" />
                <label class="form-check-label" for="Active">@localizer["Apenas relatórios ativos"]</label>
            </div>
        </div>
    </div>



    <div id="viewAll" class="card-body table-responsive">
    </div>
</div>







@section Scripts
{
    <script>
        $(document).ready(function () {


            $("#ReportType").on("change", function () {
                console.log("ReportType foi atualizada = " + $("#ReportType").val());
                $('#reportTemplateTable').DataTable().draw();
            });


            $("#VersionIndex").on("change", function () {
                console.log("VersionIndex foi atualizada = " + $("#VersionIndex").val());
                $('#reportTemplateTable').DataTable().draw();
            });


             $("#ActiveIndex").on("change", function () {
                console.log("ActiveIndex foi clickada = " + $('#ActiveIndex').is(':checked'));
                $('#reportTemplateTable').DataTable().draw();
            });




            loadData();

            $('#reload').on('click', function () {
                loadData();
            });
        });

        function loadData() {
            $('#viewAll').load('/report/ReportTemplate/LoadAll');
        }

    </script>
}